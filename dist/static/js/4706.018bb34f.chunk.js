"use strict";(self.webpackChunkreact_ant_admin=self.webpackChunkreact_ant_admin||[]).push([[4706,4909,4410],{1303:function(e,t,n){n.r(t);var r=n(1413),a=n(15671),u=n(43144),c=n(97326),o=n(60136),s=n(29388),l=n(34706),i=n(18431),d=n(35099),f=n(76884),p=n(89325),h=n(84909),v=n(10161),m=i.Z.Dragger,x=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;(0,a.Z)(this,n);for(var r=arguments.length,u=new Array(r),o=0;o<r;o++)u[o]=arguments[o];return(e=t.call.apply(t,[this].concat(u))).state={excelData:{header:null,results:null}},e.draggerProps=function(){var t=(0,c.Z)(e);return{name:"file",multiple:!1,accept:".xlsx, .xls",onChange:function(e){var t=e.file.status;"done"===t?d.ZP.success("".concat(e.file.name," 文件上传成功")):"error"===t&&d.ZP.error("".concat(e.file.name," 文件上传失败"))},beforeUpload:function(e,t){if(!function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}(e))return d.ZP.error("仅支持上传.xlsx, .xls, .csv 文件"),!1},customRequest:function(e){t.readerData(e.file).then((function(){e.onSuccess()}))}}},e.readerData=function(t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(t){var r=t.target.result,a=f.ij(r,{type:"array"}),u=a.SheetNames[0],c=a.Sheets[u],o=function(e){var t,n=[],r=f.P6.decode_range(e["!ref"]),a=r.s.r;for(t=r.s.c;t<=r.e.c;++t){var u=e[f.P6.encode_cell({c:t,r:a})],c="UNKNOWN "+t;u&&u.t&&(c=f.P6.format_cell(u)),n.push(c)}return n}(c),s=f.P6.sheet_to_json(c);e.generateData({header:o,results:s}),n()},a.readAsArrayBuffer(t)}))},e.generateData=function(t){var n=t.header,r=t.results;e.setState({excelData:{header:n,results:r}}),e.props.uploadSuccess&&e.props.uploadSuccess(e.state.excelData)},e}return(0,u.Z)(n,[{key:"render",value:function(){return(0,v.jsx)("div",{children:(0,v.jsxs)(m,(0,r.Z)((0,r.Z)({},this.draggerProps()),{},{children:[(0,v.jsx)("p",{className:"ant-upload-drag-icon",children:(0,v.jsx)(p.default,{iconClass:"upload",className:h.default.upload})}),(0,v.jsx)("p",{className:"ant-upload-text",children:"Drop excel file here or click here"})]}))})}}]),n}(l.Component);t.default=x},84410:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var r=n(1413),a=n(81642),u=n(10161);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(n){return t&&(0,a.Z)(t),(0,u.jsx)(e,(0,r.Z)({},n))}}},4706:function(e,t,n){n.r(t);var r=n(15671),a=n(43144),u=n(60136),c=n(29388),o=n(34706),s=n(9172),l=n(1303),i=n(84410),d=n(10161),f=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return(e=t.call.apply(t,[this].concat(u))).state={tableData:[],tableHeader:[]},e.handleSuccess=function(t){var n=t.results,r=t.header;e.setState({tableData:n,tableHeader:r})},e}return(0,a.Z)(n,[{key:"render",value:function(){return(0,d.jsxs)("div",{className:"app-container",children:[(0,d.jsx)(l.default,{uploadSuccess:this.handleSuccess}),(0,d.jsx)("br",{}),(0,d.jsx)(s.Z,{bordered:!0,columns:this.state.tableHeader.map((function(e){return{title:e,dataIndex:e,key:e,width:195,align:"center"}})),dataSource:this.state.tableData})]})}}]),n}(o.Component);t.default=(0,i.default)(f,"表格上传")},81642:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(34706),a=(n(65953),function(e){var t,n,a=(t=e,(n=(0,r.useRef)(t)).current=t,n);(0,r.useEffect)((function(){return function(){a.current()}}),[])}),u=!("undefined"==typeof window||!window.document||!window.document.createElement),c={restoreOnUnmount:!1},o=function(e,t){void 0===t&&(t=c);var n=(0,r.useRef)(u?document.title:"");(0,r.useEffect)((function(){document.title=e}),[e]),a((function(){t.restoreOnUnmount&&(document.title=n.current)}))}},65953:function(e,t,n){n.d(t,{mf:function(){return r}});var r=function(e){return"function"==typeof e}},84909:function(e,t,n){n.r(t),t.default={upload:"UploadExcel_upload__RiN-1"}}}]);